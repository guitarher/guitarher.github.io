<script setup>
  import img from '/imgs/前端基础/请求报文.png'
  import img1 from '/imgs/前端基础/响应报文.png'
  import img2 from '/imgs/前端基础/正向代理.png'
  import img3 from '/imgs/前端基础/反向代理.png'
  import img4 from '/imgs/前端基础/正向代理作用.png'
  import img5 from '/imgs/前端基础/反向代理作用.png'
  import img6 from '/imgs/前端基础/抓包工具原理.png'
  import img7 from '/imgs/前端基础/cdn.png'
  import img8 from '/imgs/前端基础/sack.png'
  import img9 from '/imgs/前端基础/拥塞控制.png'
  import img10 from '/imgs/前端基础/慢开始.png'
  import img11 from '/imgs/前端基础/慢开始1.png'
  import img12 from '/imgs/前端基础/拥塞避免.png'
  import img13 from '/imgs/前端基础/快重传.png'
  import img14 from '/imgs/前端基础/快重传+快恢复.png'
  import img15 from '/imgs/前端基础/序号、确认号.png'
  import img16 from '/imgs/前端基础/序号、确认号1.png'
  import img17 from '/imgs/前端基础/序号、确认号2.png'
  import img18 from '/imgs/前端基础/序号、确认号3.png'
  import img19 from '/imgs/前端基础/序号、确认号4.png'
  import img20 from '/imgs/前端基础/3次握手.png'
  import img21 from '/imgs/前端基础/4次挥手.png'
</script>

# HTTP

## 概述

- **HTTP**（Hyper Text Transfer Protocol），译为超文本传输协议
  - 是互联网中应用最广泛的应用层协议之一
  - 设计HTTP最初的目的是：提供一种发布和接收HTML页面的方法，由URI来标识具体的资源
  - 后面用HTTP来传递的数据格式不仅仅是HTML，应用非常广泛

- **HTML**（Hyper Text Markup Language）：超文本标记语言，用以编写网页

## 版本

- **HTTP/0.9**（1991年）：只支持GET请求方法获取文本数据（比如HTML文档），且不支持请求头、响应头等，无法向服务器传递太多信息
- **HTTP/1.0**（1996年）：支持POST、HEAD等请求方法，支持请求头、响应头等，支持更多种数据类型（不再局限于文本数据）。浏览器的每次请求都需要与服务器建立一个TCP连接，请求处理完成后立即断开TCP连接
- **HTTP/1.1**（1997年）：支持PUT、DELETE等请求方法。采用持久连接（Connection: keep-alive），多个请求可以共用同一个TCP连接
- **HTTP/2.0**（2015年）
- **HTTP/3.0**（2018年）

## 标准

- HTTP的标准由万维网协会（W3C）、互联网工程任务组（IETF）协调制定，最终发布了一系列的RFC
- **RFC**（Request For Comments，请求意见稿）
  - HTTP/1.1最早是在1997年的RFC 2068中记录的，该规范在1999年的RFC 2616中已作废，2014年又由RFC 7230系列的RFC取代
  - HTTP/2标准于2015年5月以RFC 7540正式发表，取代HTTP/1.1成为HTTP的实现标准

## 报文格式

### 请求报文
<img :src="img"/>

### 响应报文
<img :src="img1"/>

## URL的编码

- URL中一旦出现了一些特殊字符（比如中文、空格），需要进行编码
- 在浏览器地址栏输入URL时，是采用UTF-8进行编码
  - 编码前：`https://www.baidu.com/s?wd=百度`
  - 编码后：`https://www.baidu.com/s?wd=%E5%8D%8E%E4%B8%BA`

## 请求方法

- **RFC 7231, section 4: Request methods:** 描述了8种请求方法
  - GET、HEAD、POST、PUT、DELETE、CONNECT、OPTIONS、TRACE
- **RFC 5789, section 2: Patch method:** 描述了PATCH方法
- **GET:** 常用于读取的操作，请求参数直接拼接在URL的后面（浏览器对URL是有长度限制的）
- **POST:** 常用于添加、修改、删除的操作，请求参数可以放到请求体中（没有大小限制）
- **HEAD:** 请求得到与GET请求相同的响应，但没有响应体
- **OPTIONS:** 用于获取目的资源所支持的通信选项，比如服务器支持的请求方法
- **PUT:** 用于对已存在的资源进行整体覆盖
- **PATCH:** 用于对资源进行部分修改（资源不存在，会创建新的资源）
- **DELETE:** 用于删除指定的资源
- **TRACE:** 请求服务器回显其收到的请求信息，主要用于HTTP请求的测试或诊断
- **CONNECT:** 可以开启一个客户端与所请求资源之间的双向沟通的通道，它可以用来创建隧道（tunnel）

## 头部字段（Header Field）

- **请求头字段（Request Header Fields）:** 有关要获取的资源或客户端本身信息的消息头
- **响应头字段（Response Header Fields）:** 有关响应的补充信息，比如服务器本身（名称和版本等）的消息头
- **实体头字段（Entity Header Fields）:** 有关实体主体的更多信息，比如主体长度（Content-Length）或其MIME类型
- **通用头字段（General Header Fields）:** 同时适用于请求和响应消息，但与消息主体无关的消息头

### 请求头字段

| 头字段名        | 说明                                                        | 示例                                                 |
| --------------- | ----------------------------------------------------------- | ---------------------------------------------------- |
| User-Agent      | 浏览器的身份标识字符串                                      | User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:12.0) |
| Host            | 服务器的域名、端口号                                        | Host: localhost:80                                   |
| Date            | 发送该消息的日期和时间                                      | Date: Tue, 15 Nov 1994 08:12:31 GMT                  |
| Referer         | 表示浏览器所访问的前一个页面                                | Referer: https://www.baidu.com                       |
|                 | 正是前一个页面的某个链接将浏览器带到了当前这个页面          |                                                      |
| Content-Type    | 请求体的类型                                                | Content-Type: multipart/form-data                    |
| Content-Length  | 请求体的长度（字节为单位）                                  | Content-Length: 348                                  |
| Accept          | 能够接受的响应内容类型 (Content-Types)                      | Accept: text/plain                                   |
| Accept-Charset  | 能够接受的字符集                                            | Accept-Charset: GB2312, utf-8; q=0.7, *; q=0.7       |
| Accept-Encoding | 能够接受的编码方式列表                                      | Accept-Encoding: gzip, deflate                       |
| Accept-Language | 能够接受的响应内容的自然语言列表                            | Accept-Language: en-US                               |
| Range           | 仅请求某个实体的一部分。字节偏移以0开始                     | Range: bytes=500-999                                 |
| Origin          | 发起一个针对跨域资源共享的请求                              | Origin: https://www.baidu.com                        |
| Cookie          | 之前由服务器通过Set-Cookie发送的Cookie                      | Cookie: $Version=1; Skin=new;                        |
| Connection      | 该浏览器想要优先使用的连接类型                              | Connection: keep-alive                               |
| Cache-Control   | 用来指定在这次的请求/响应链中的所有缓存机制都必须遵守的指令 | Cache-Control: no-cache                              |

### 响应头字段


## 状态码（Status Code）

- **信息响应：** 100~199
- **成功响应：** 200~299
- **重定向：** 300~399
- **客户端错误：** 400~499
- **服务器错误：** 500~599

### 常见状态码

- **100 Continue:** 请求的初始部分已经被服务器收到，并且没有被服务器拒绝。客户端应该继续发送剩余的请求，如果请求已经完成，就忽略这个响应
- **200 OK:** 请求成功
- **302 Found:** 请求的资源被暂时的移动到了由Location头部指定的URL上
- **304 Not Modified:** 说明无需再次传输请求的内容，也就是说可以使用缓存的内容
- **400 Bad Request:** 由于语法无效，服务器无法理解该请求
- **401 Unauthorized:** 由于缺乏目标资源要求的身份验证凭证
- **403 Forbidden:** 服务器端有能力处理该请求，但是拒绝授权访问
- **404 Not Found:** 服务器端无法找到所请求的资源
- **405 Method Not Allowed：**服务器禁止了使用当前HTTP方法的请求
- **406 Not Acceptable：**服务器端无法提供与Accept-Charset以及Accept-Language指定的值相匹配的响应
- **408 Request Timeout：**服务器想要将没有在使用的连接关闭，一些服务器会在空闲连接上发送此信息，即便是在客户端没有发送任何请求的情况下
- **500 Internal Server Error:** 所请求的服务器遇到意外的情况并阻止其执行请求
- **501 Not Implemented：**请求的方法不被服务器支持，因此无法被处理，服务器必须支持的方法（即不会返回这个状态码的方法）只有GET 和HEAD
- **502 Bad Gateway：**作为网关或代理角色的服务器，从上游服务器（如tomcat）中接收到的响应是无效的
- **503 Service Unavailable：**服务器尚未处于可以接受请求的状态通常造成这种情况的原因是由于服务器停机维护或者已超载

## form提交 - 常用属性
- **action：**请求的URI
- **method：**请求方法（GET、POST）
- **enctype：**POST请求时，请求体的编码方式
  - application/x-www-form-urlencoded（默认值）
  - 用&分隔参数，用=分隔键和值，字符用URL编码方式进行编码
- **multipart/form-data**
  - 文件上传时必须使用这种编码方式

## 代理服务器 (Proxy Server)

- **特点**
  - 本身不生产内容
  - 处于中间位置转发上下游的请求和响应
    - 面向下游的客户端：它是服务器
    - 面向上游的服务器：它是客户端

### 正向代理、反向代理

- **正向代理:** 代理的对象是客户端
<img :src="img2"/>

- **反向代理:** 代理的对象是服务器
<img :src="img3"/>

### 正向代理 - 作用

- 隐藏客户端身份
- 绕过防火墙（突破访问限制）
- Internet访问控制
- 数据过滤
<img :src="img4"/>

### 反向代理 - 作用

- 隐藏服务器身份
- 安全防护
- 负载均衡
<img :src="img5"/>

## 抓包工具的原理
- Fiddler、Charles等抓包工具的原理：在客户端启动了正向代理服务
- 需要注意的是
  - Wireshark的原理是：通过底层驱动，拦截网卡上流过的数据
<img :src="img6"/>

## CDN（Content Delivery Network）

- **CDN**（Content Delivery Network或Content Distribution Network），译为：内容分发网络
- 利用最靠近每位用户的服务器，更快更可靠地将音乐、图片、视频等资源文件（一般是静态资源）传递给用户
<img :src="img7"/>

### CDN － 使用CDN前后

- **使用前:** 服务主机负载过量
- **使用后:** 服务主机负载正常
- CDN运营商在全国、乃至全球的各个大枢纽城市都建立了机房，部署了大量拥有高存储高带宽的节点，构建了一个跨运营商、跨地域的专用网络
- 内容所有者向CDN运营商支付费用，CDN将其内容交付给最终用户